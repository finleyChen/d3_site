<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    <link href="style.css" rel="stylesheet">
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  </head>
  <body>
	<form id="svgform" method="post" action="download.pl">
	   <input type="hidden" id="output_format" name="output_format" value="">
	   <input type="hidden" id="data" name="data" value="">
	</form>
    <div class="chart" id='ex1'></div>
    <script type="text/javascript" src="script.js"></script>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script type="text/javascript">
	function submit_download_form(output_format)
	{
		// Get the d3js SVG element
		var tmp = document.getElementById("ex1");
		var svg = tmp.getElementsByTagName("svg")[0];
		// Extract the data as SVG text string
		var svg_xml = (new XMLSerializer).serializeToString(svg);
		var form = document.getElementById("svgform");
		form['output_format'].value = output_format;
		form['data'].value = svg_xml ;
		form.submit();
	}
	$(document).ready(function() {
		$("#save_as_png").click(function() { submit_download_form("png"); });
	});
	</script>
    
  </body>
  <div class="row">
  	<div class="span12">
  		<h2>Export Drawing</h2>

  		<br/>
  		<button class="btn btn-success" id="save_as_png" value="">
  			Save as High-Res PNG</button>
  		<br>
  		</pre>
  	</div>
  </div>
</html>